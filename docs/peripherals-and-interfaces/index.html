<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-peripherals-and-interfaces" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">外设与接口 | Android110</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://android110.github.io/android110.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://android110.github.io/android110.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://android110.github.io/android110.github.io/docs/peripherals-and-interfaces"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="外设与接口 | Android110"><meta data-rh="true" name="description" content="硬件资源图"><meta data-rh="true" property="og:description" content="硬件资源图"><link data-rh="true" rel="icon" href="/android110.github.io/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://android110.github.io/android110.github.io/docs/peripherals-and-interfaces"><link data-rh="true" rel="alternate" href="https://android110.github.io/android110.github.io/docs/peripherals-and-interfaces" hreflang="en"><link data-rh="true" rel="alternate" href="https://android110.github.io/android110.github.io/docs/peripherals-and-interfaces" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"外设与接口","item":"https://android110.github.io/android110.github.io/docs/peripherals-and-interfaces"}]}</script><link rel="alternate" type="application/rss+xml" href="/android110.github.io/blog/rss.xml" title="Android110 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/android110.github.io/blog/atom.xml" title="Android110 Atom Feed"><link rel="stylesheet" href="/android110.github.io/assets/css/styles.4fff4710.css">
<script src="/android110.github.io/assets/js/runtime~main.f8d0e09f.js" defer="defer"></script>
<script src="/android110.github.io/assets/js/main.f8a1b91c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/android110.github.io/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/android110.github.io/"><div class="navbar__logo"><img src="/android110.github.io/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/android110.github.io/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/android110.github.io/docs/peripheral-compatibility-list">Tutorial</a><a class="navbar__item navbar__link" href="/android110.github.io/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/android110.github.io/docs/peripheral-compatibility-list">外设兼容列表</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/android110.github.io/docs/revision-history">文档更新说明</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/android110.github.io/docs/quick-start/">快速入门</a><button aria-label="Expand sidebar category &#x27;快速入门&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/android110.github.io/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/android110.github.io/docs/peripherals-and-interfaces">外设与接口</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/android110.github.io/docs/qualcomm-ai-hub">Qualcomm AI Hub</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/android110.github.io/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">外设与接口</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>外设与接口</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="硬件资源图">硬件资源图<a href="#硬件资源图" class="hash-link" aria-label="Direct link to 硬件资源图" title="Direct link to 硬件资源图">​</a></h2>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-55-20dc27f46f7587e5dc5caa94aa151a5e.jpg" width="1000" height="422" class="img_ev3q"></p>
<table><thead><tr><th>序号</th><th>接口</th><th>序号</th><th>接口</th></tr></thead><tbody><tr><td>1</td><td>RTC 电池接口</td><td>10</td><td>电源 Type-C 接口</td></tr><tr><td>2</td><td>Micro USB (UART 调试)</td><td>11</td><td>PWR 按键</td></tr><tr><td>3</td><td>TurboX C6490P SOM</td><td>12</td><td>EDL 按键</td></tr><tr><td>4</td><td>3.5mm 耳机接口</td><td>13</td><td>摄像头接口 2</td></tr><tr><td>5</td><td>USB Type-C with DP (USB 3.1)</td><td>14</td><td>摄像头接口 1</td></tr><tr><td>6</td><td>USB Type-A (USB 2.0)</td><td>15</td><td>Wi-Fi/蓝牙模块</td></tr><tr><td>7</td><td>2 x USB Type-A (USB 3.0)</td><td>16</td><td>风扇接口</td></tr><tr><td>8</td><td>1000M 以太网</td><td>17</td><td>40-pin 连接器</td></tr><tr><td>9</td><td>HDMI OUT</td><td>18</td><td>M.2 Key M 接口</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="40-pin-连接器">40 pin 连接器<a href="#40-pin-连接器" class="hash-link" aria-label="Direct link to 40 pin 连接器" title="Direct link to 40 pin 连接器">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gpio">GPIO<a href="#gpio" class="hash-link" aria-label="Direct link to GPIO" title="Direct link to GPIO">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布">引脚分布<a href="#引脚分布" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和开源开发板的40-pin连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-54-0feea997254dd8c83455c76190d30f83.jpg" width="1000" height="634" class="img_ev3q"></p>
<p>下表是 40-pin连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-53-21fe4b787a7212f3363ba770cf072c16.jpg" width="1000" height="422" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-shell-命令控制">使用 shell 命令控制<a href="#使用-shell-命令控制" class="hash-link" aria-label="Direct link to 使用 shell 命令控制" title="Direct link to 使用 shell 命令控制">​</a></h4>
<p>在 RUBIK Pi 3 中执行下面的步骤控制 GPIO。</p>
<p>GPIO 引脚通过 <em>/sys/class/gpio</em> 目录进行管理。运行<code>ls -alt</code>命令可查看当前目录引脚信息。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-59-aa1b7cbc6c75596576568bf9e8010d41.jpg" width="1000" height="205" class="img_ev3q"></p>
<p>GPIO 引脚并非随意分布，而是被组织成多个 GPIO Chip（引脚组），每个 Chip 管理一组连续的引脚，并有唯一的编号。例如上图中，gpiochip336 基地址为 336，管理从引脚 336 开始的引脚。</p>
<p>gpiochip336 由主控制器（pinctrl 控制器）管理，pinctrl 负责配置引脚功能（如 GPIO、SPI 等），适用于通用引脚，而其他 GPIO Chip 则由专用控制器管理，负责特定任务的引脚。</p>
<p>如果想要引用该组中的某个 GPIO 引脚，需要使用基地址加上偏移量（下表中的引脚编号）。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-265-dd4b7eb7fbad5f1d5781f3e96373a5e1.jpg" width="875" height="886" class="img_ev3q"></p>
<p>以控制 12 号引脚 GPIO_101 为例，需进行如下操作：</p>
<ul>
<li>
<p>进入 <em>/sys/class/gpio </em>目录：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/class/gpio</span><br></span></code></pre></div></div>
</li>
<li>
<p>导出要控制的 GPIO。gpio336 基地址 336 + 偏移量 12（即引脚编号）= 348，运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 348 &gt; export</span><br></span></code></pre></div></div>
</li>
<li>
<p>进入到 <em>gpio348</em> 目录设置 GPIO 属性：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd gpio 348</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls -alt</span><br></span></code></pre></div></div>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-50-51cc2cb37a0ce2c5d94938fca48bf97f.jpg" width="995" height="293" class="img_ev3q"></p>
<ul>
<li>
<p>direction（方向）：</p>
<ul>
<li>
<p>输入：in</p>
</li>
<li>
<p>输出：out</p>
</li>
</ul>
</li>
<li>
<p>value（值）：</p>
<ul>
<li>
<p>低电平：0</p>
</li>
<li>
<p>高电平：1</p>
</li>
</ul>
</li>
<li>
<p>edge （中断边沿）：</p>
<ul>
<li>
<p>上升沿触发：rising</p>
</li>
<li>
<p>下降沿触发：falling</p>
</li>
<li>
<p>双边沿触发：both</p>
</li>
<li>
<p>禁用中断：none</p>
</li>
</ul>
</li>
</ul>
<p>如设置 12 号引脚输出高电平：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo out &gt; direction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; value</span><br></span></code></pre></div></div>
<p>取消导出 12 号引脚到用户空间：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 348 &gt; unexport</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="i2c">I2C<a href="#i2c" class="hash-link" aria-label="Direct link to I2C" title="Direct link to I2C">​</a></h3>
<p>I2C 是飞利浦公司在 20 世纪 80 年代开发的一种双向 2 线制总线，用于实现高效的 IC 间控制总线。总线上的每个设备都有其唯一的地址（由飞利浦公司领导的 I2C 总机构注册）。I2C 核心支持多控制器模式，以及 10 位目标地址和 10 位可扩展地址。关于 I2C 的更多信息，请参阅 <a href="https://www.i2c-bus.org/fileadmin/ftp/i2c_bus_specification_1995.pdf%E3%80%82" target="_blank" rel="noopener noreferrer">https://www.i2c-bus.org/fileadmin/ftp/i2c_bus_specification_1995.pdf。</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-1">引脚分布<a href="#引脚分布-1" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和开源开发板的40-pin连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-51-0feea997254dd8c83455c76190d30f83.jpg" width="1000" height="634" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>3 号引脚和 5 号引脚默认已设置配为 I2C1。</p>
</blockquote></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-52-21fe4b787a7212f3363ba770cf072c16.jpg" width="1000" height="422" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-shell-命令测试">使用 shell 命令测试<a href="#使用-shell-命令测试" class="hash-link" aria-label="Direct link to 使用 shell 命令测试" title="Direct link to 使用 shell 命令测试">​</a></h4>
<p>在 RUBIK Pi 3 中执行下面步骤控制 I2C 总线。</p>
<ul>
<li>
<p>找到要测试的 I2C 设备</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/class/i2c-dev/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls -alt</span><br></span></code></pre></div></div>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-71-06f58d1493f36f4226333bab2881050d.jpg" width="1000" height="140" class="img_ev3q"></p>
<ul>
<li>
<p>使用 i2cdetect 工具，以下操作以i2c-8为例。</p>
<ul>
<li>
<p>查看 I2C8 接口上的设备：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cdetect -a -y -r 8</span><br></span></code></pre></div></div>
<ul>
<li>
<p>每个后缀的含义</p>
<p><code>-a</code>：扫描所有可能的 I2C 地址。</p>
<p><code>-y</code>：跳过交互式确认。</p>
<p><code>-r</code>：使用 SMBus 的 <code>receive byte</code> 命令进行检测。</p>
<p><code>8</code>：指定要扫描的 I2C 总线号。</p>
</li>
</ul>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-70-2547a2735a7db82f28c688fc498e3f63.jpg" width="590" height="222" class="img_ev3q"></p>
<p>这里的 UU 代表内核中已经有了I2C8这个驱动，可以进行通信，表示成功使能。</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spi">SPI<a href="#spi" class="hash-link" aria-label="Direct link to SPI" title="Direct link to SPI">​</a></h3>
<p>串行外设接口 (SPI) 是在全双工模式下工作的同步串行数据链路。SPI 又称为 4 线制串行总线。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-2">引脚分布<a href="#引脚分布-2" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和开源开发板的40-pin连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-69-0feea997254dd8c83455c76190d30f83.jpg" width="1000" height="634" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>19 号、21 号、23 号、24 号引脚默认已设置配为 SPI。</p>
</blockquote></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-68-21fe4b787a7212f3363ba770cf072c16.jpg" width="1000" height="422" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序-spi-通信">使用 C 语言程序 SPI 通信<a href="#使用-c-语言程序-spi-通信" class="hash-link" aria-label="Direct link to 使用 C 语言程序 SPI 通信" title="Direct link to 使用 C 语言程序 SPI 通信">​</a></h4>
<ul>
<li>
<p>以下代码示例，代码使用 SPI 总线进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdint.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;getopt.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;fcntl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/ioctl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/types.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/spi/spidev.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/time.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;signal.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name function" style="color:#d73a49">ARRAY_SIZE</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">a</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression keyword" style="color:#00009f">sizeof</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">a</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression operator" style="color:#393A34">/</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression keyword" style="color:#00009f">sizeof</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">a</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression punctuation" style="color:#393A34">[</span><span class="token macro property expression number" style="color:#36acaa">0</span><span class="token macro property expression punctuation" style="color:#393A34">]</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">abort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">device </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/dev/spidev0.0&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*spi controller device file*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">uint8_t</span><span class="token plain"> mode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">uint8_t</span><span class="token plain"> bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">uint32_t</span><span class="token plain"> speed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//5242880hz--&gt;655360B/s--&gt;5mbps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">uint16_t</span><span class="token plain"> delay</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">prompt_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> signo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init_sigaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">sigaction</span><span class="token plain"> tact</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tact</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sa_handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> prompt_info</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tact</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sa_flags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sigemptyset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tact</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sa_mask</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sigaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SIGALRM</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tact</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init_time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">itimerval</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">it_value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tv_sec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Transmission time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">it_value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tv_usec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">it_interval </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">it_value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">setitimer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ITIMER_REAL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">transfer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> temp</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;n&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;o&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;p&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;q&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;s&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;e&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;f&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;g&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;e&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;f&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;g&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;e&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;f&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;g&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;t&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;u&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;h&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;i&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;j&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;k&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;l&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;m&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;e&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;f&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;g&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;e&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;f&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;g&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;e&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;f&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;g&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token char">&#x27;v&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> tx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//Array of data to be sent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">memcpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> temp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//Received data array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">spi_ioc_transfer</span><span class="token plain"> tr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tx_buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rx_buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">rx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">delay_usecs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> delay</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">speed_hz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> speed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bits_per_word </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">init_sigaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">init_time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">file_write </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">file_read </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file_write </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;writebuf&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;w+&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file_read </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;readbuf&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;w+&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SPI_IOC_MESSAGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">//ioctl default operation, transfer data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t send spi message&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                size</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fwrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> file_write</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fwrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> file_read</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">memcpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> temp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">memset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x00</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_write</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_read</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">print_usage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">prog</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">//If the parameter is wrong, print the help information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Usage: %s [-DsbdlHOLC3]\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prog</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">puts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;  -D --device   device to use (default /dev/spidev3.0)\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -s --speed    max speed (Hz)\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -d --delay    delay (usec)\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -b --bpw      bits per word \n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -l --loop     loopback\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -H --cpha     clock phase\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -O --cpol     clock polarity\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -L --lsb      least significant bit first\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -C --cs-high  chip select active high\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -3 --3wire    SI/SO signals shared\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parse_opts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">option</span><span class="token plain"> lopts</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//Parameter command table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;device&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;D&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;speed&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;s&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;delay&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bpw&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;b&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;loop&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;l&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cpha&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;H&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cpol&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;O&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;lsb&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;L&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cs-high&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;C&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3wire&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;3&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;no-cs&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;N&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ready&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;R&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getopt_long</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> argv</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;D:s:d:b:lHOLC3NR&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lopts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;D&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            device </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optarg</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;s&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            speed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">atoi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optarg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            delay </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">atoi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optarg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;b&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">atoi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optarg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;l&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> SPI_LOOP</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;H&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> SPI_CPHA</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;O&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> SPI_CPOL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;L&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> SPI_LSB_FIRST</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;C&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> SPI_CS_HIGH</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;3&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> SPI_3WIRE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;N&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> SPI_NO_CS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;R&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> SPI_READY</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">print_usage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">parse_opts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> argv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">puts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t open device&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * spi mode </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_WR_MODE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t set spi mode&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_RD_MODE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t get spi mode&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * bits per word </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_WR_BITS_PER_WORD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">bits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t set bits per word&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_RD_BITS_PER_WORD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">bits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t get bits per word&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * max speed hz</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_WR_MAX_SPEED_HZ</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">speed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t set max speed hz&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_RD_MAX_SPEED_HZ</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">speed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t get max speed hz&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;spi mode: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;bits per word: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;max speed: %d Hz (%d KHz)\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> speed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> speed</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">transfer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-linux-gnu-gcc {filename} -o {输出filename} -static</span><br></span></code></pre></div></div>
</li>
<li>
<p>使用的交叉编译，需要将 spi 传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi /dev</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155529-ebda72d74fd3eac3f07abfc02a5de947.jpg" width="1000" height="750" class="img_ev3q"></p>
<ol>
<li>
<p><strong>设备检查（确认 SPI 设备存在）​​</strong></p>
<ol>
<li>进入设备终端：</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span></code></pre></div></div>
<ol start="2">
<li>切换到 root 权限：</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">su</span><br></span></code></pre></div></div>
<ol start="3">
<li>进入 /dev 目录并检查 SPI 设备文件：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls | grep spidev</span><br></span></code></pre></div></div>
</li>
</ol>
<p>预期结果：</p>
<p>存在类似 spidev0.0 的设备节点（名称可能略有差异）。</p>
<ol start="2">
<li>
<p><strong>测试文件推送与执行</strong></p>
<ol>
<li>另开终端，推送测试程序：</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi_test /dev</span><br></span></code></pre></div></div>
<ol start="2">
<li>回到设备终端，确认文件传输成功：</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls</span><br></span></code></pre></div></div>
<p>应看到新文件 spi_test（与 spidev0.0 区分）。</p>
<ol start="3">
<li>赋予 spi_test 执行权限并运行测试：</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 777 spi_test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./spi_test</span><br></span></code></pre></div></div>
</li>
</ol>
<p>预期结果：</p>
<p>生成 writebuf（发送数据）和 readbuf（接收数据）文件。</p>
<ol start="3">
<li><strong>验证数据传输</strong></li>
</ol>
<p>对比两个文件内容：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">diff writebuf readbuf</span><br></span></code></pre></div></div>
<p>预期结果：</p>
<p>无输出（文件完全一致），表示 SPI 传输成功且无丢包。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-72-02738a336fb6270455d0840e2babf896.jpg" width="575" height="157" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uart">UART<a href="#uart" class="hash-link" aria-label="Direct link to UART" title="Direct link to UART">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-3">引脚分布<a href="#引脚分布-3" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和开源开发板的40-pin连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-67-0feea997254dd8c83455c76190d30f83.jpg" width="1000" height="634" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>8 号和 10 号引脚默认已设置配为 UART，设备节点为 <em>/dev/ttyHS3</em>。</p>
</blockquote></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-66-21fe4b787a7212f3363ba770cf072c16.jpg" width="1000" height="422" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序-uart-通信">使用 C 语言程序 UART 通信<a href="#使用-c-语言程序-uart-通信" class="hash-link" aria-label="Direct link to 使用 C 语言程序 UART 通信" title="Direct link to 使用 C 语言程序 UART 通信">​</a></h4>
<ul>
<li>
<p>以下代码示例，使用 UART 进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/types.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/stat.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;fcntl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;termios.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;errno.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;pthread.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;signal.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/ioctl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;getopt.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name function" style="color:#d73a49">ARRAY_SIZE</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">a</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression keyword" style="color:#00009f">sizeof</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">a</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression operator" style="color:#393A34">/</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression keyword" style="color:#00009f">sizeof</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">a</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression punctuation" style="color:#393A34">[</span><span class="token macro property expression number" style="color:#36acaa">0</span><span class="token macro property expression punctuation" style="color:#393A34">]</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">MAX_SIZE</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> bps_speed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">115200</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">device </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/dev/ttyHS1&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> data_bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> stop_bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> g_parity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;N&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">type </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;read&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">abort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> speed_arr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">B1152000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B1000000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B921600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B576000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B500000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B460800</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B230400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B115200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B57600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B38400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B19200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B9600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B4800</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B2400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B1200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B300</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> name_arr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1152000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">921600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">576000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">500000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">460800</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">230400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">115200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">57600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">38400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">19200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">9600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">4800</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">2400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">300</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 设置波特率</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">set_speed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> speed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> status</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">termios</span><span class="token plain"> Opt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">tcgetattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">Opt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">speed_arr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">speed </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> name_arr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// 缓冲区里的数据都废弃</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">tcflush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TCIOFLUSH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">/* 设置串口的波特率 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">cfsetispeed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">Opt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> speed_arr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">cfsetospeed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">Opt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> speed_arr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            status </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tcsetattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TCSANOW</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">Opt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">status </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;tcsetattr fd&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">tcflush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TCIOFLUSH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;error speed!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">set_Parity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> databits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> stopbits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> parity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> cmd_fileclear</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// sprintf(cmd_fileclear, &quot;: &gt; %s&quot;, device);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// system(cmd_fileclear);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// memset(cmd_fileclear, 0, ARRAY_SIZE(cmd_fileclear));</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd_fileclear</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;stty -F %s -echo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd_fileclear</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">memset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd_fileclear</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd_fileclear</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// printf(&quot;%s\n&quot;, cmd_fileclear);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">termios</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tcgetattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SetupSerial 1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">CSIZE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">databits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*设置数据位数*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> CS7</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> CS8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Unsupported data sizen&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;n&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;N&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">PARENB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* Clear parity enable */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_iflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">INPCK</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/* Enable parity checking */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;o&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;O&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PARODD </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> PARENB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 设置为奇效验*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_iflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> INPCK</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic">/* Disnable parity checking */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;e&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;E&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> PARENB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/* Enable parity */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">PARODD</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* 转换为偶效验*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_iflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> INPCK</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">/* Disnable parity checking */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;S&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;s&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*as no parity*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">PARENB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">CSTOPB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Unsupported parityn&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stopbits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">CSTOPB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> CSTOPB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Unsupported stop bits&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* Set input parity option */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parity </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token char">&#x27;n&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> parity </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token char">&#x27;N&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_iflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> INPCK</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">VTIME</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">150</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 15 seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">VMIN</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">tcflush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TCIFLUSH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* Update the options and do it NOW */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tcsetattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TCSANOW</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SetupSerial 3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">print_usage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">prog</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//If the parameter is wrong, print the help information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Usage: %s [-DsbdlHOLC3t]\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prog</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">puts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;  -D --device     device to use (default /dev/ttyHS3)\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -S --speed      bps\n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -d --databits   \n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -s --stopbits   \n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -p --parity     \n&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string" style="color:#e3116c">&quot;  -T --type       read or write\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parse_opts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">option</span><span class="token plain"> lopts</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">//Parameter command table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;device&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;D&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;speed&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;S&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;databits&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;stopbits&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;s&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;parity&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;p&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;T&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getopt_long</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> argv</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;D:S:d:s:p:T:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lopts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;D&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            device </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optarg</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;S&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bps_speed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">atoi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optarg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;d&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            data_bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">atoi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optarg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;s&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            stop_bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">atoi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optarg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;p&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            g_parity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">atoi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optarg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token char">&#x27;T&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            type </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optarg</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">print_usage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> string1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello_world\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> string2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello_world_abcdefghijklmnopqrstuvwxyz_abcdefghijklmnopqrstuvwxyz_abcdefghijklmnopqrstuvwxyz_abcdefghijklmnopqrstuvwxyz_abcdefghijklmnopqrstuvwxyz_abcdefghijklmnopqrstuvwxyz\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">string </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> string2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">parse_opts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> argv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">puts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pabort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;can&#x27;t open device&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 设置波特率</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">set_speed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bps_speed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">set_Parity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_bits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stop_bits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> g_parity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> nread </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">nwrite </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buff</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MAX_SIZE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> num </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> send_msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%d %d-%d-%c\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bps_speed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_bits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stop_bits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> g_parity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;type:%s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;read&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;read&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;write&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">memset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">send_msg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">send_msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">read_file</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;read&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// tcflush(fd, TCIOFLUSH);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            nread </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buff</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MAX_SIZE </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nread </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;(Len %d):&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nread</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                buff</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">nread</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                buff</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">nread </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;read %s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buff</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nread </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    read_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;read_file&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;aw+&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token function" style="color:#d73a49">fwrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buff</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buff</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> read_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">read_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">memset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buff</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ARRAY_SIZE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buff</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                num</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            nread </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">send_msg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%d%s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            nwrite </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_msg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">send_msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Send test data---%d---%s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nwrite</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            num</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-linux-gnu-gcc {filename} -o {输出filename} -static</span><br></span></code></pre></div></div>
</li>
<li>
<p>使用交叉编译，需要将编译出的产物 <em>uart </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart /opt</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155526-cfec1adfaf28d1698db4fcbcddccaaf4.jpg" width="1000" height="750" class="img_ev3q"></p>
<ol>
<li>
<p><strong>测试读功能（接收数据）​​</strong></p>
<ol>
<li>赋权并启动监听终端</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 777 uart_test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./uart -D /dev/ttyHS1</span><br></span></code></pre></div></div>
<ol start="2">
<li>另开终端发送数据</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./uart -D /dev/ttyHS1 -T write</span><br></span></code></pre></div></div>
<ol start="3">
<li>另开终端 B 监听数据</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./uart -D /dev/ttyHS1</span><br></span></code></pre></div></div>
</li>
</ol>
<p>验证：​​</p>
<p>第一个终端会显示发送的数据，确认数据接收正常。</p>
<ol start="2">
<li>
<p><strong>测试写功能（发送数据）​​</strong></p>
<ol>
<li>在终端 A 发送数据</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./uart -D /dev/ttyHS1 -T write</span><br></span></code></pre></div></div>
<ol start="2">
<li>另开终端 B 监听数据</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./uart -D /dev/ttyHS1</span><br></span></code></pre></div></div>
</li>
</ol>
<p>验证：​​</p>
<p>终端 B 会显示终端 A 发送的数据，确认数据发送正常。</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usb">USB<a href="#usb" class="hash-link" aria-label="Direct link to USB" title="Direct link to USB">​</a></h2>
<p>RUBIK Pi 3 拥有 4 个 USB 口：</p>
<ul>
<li>
<p>两个 USB 3.0 口，只能作为主机模式使用，如下图 7。</p>
</li>
<li>
<p>一个 USB 2.0 口，可以作为主机或设备模式使用，如下图 6。</p>
</li>
<li>
<p>一个 USB 3.1 Gen 1 口，可以作为主机或设备模式，以及 DP 显示使用，如下图 5。</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-65-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-20-type-a-接口">USB 2.0 Type-A 接口<a href="#usb-20-type-a-接口" class="hash-link" aria-label="Direct link to USB 2.0 Type-A 接口" title="Direct link to USB 2.0 Type-A 接口">​</a></h3>
<p>本小节介绍如何通过 USB 2.0 Type-A接口，将 RUBIK Pi 3 配置为 USB 大容量设备（即模拟成 U 盘），来验证安卓 13 设备的 USB Gadget 功能。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p><strong>权限限制</strong>：ADB shell 权限不足以配置 USB Gadget，需使用串口控制台执行所有操作。</p>
</blockquote></div></div>
<p>请使用 USB 数据线将设备与主机 PC 连接，然后进行以下步骤：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="设备模式验证">设备模式验证<a href="#设备模式验证" class="hash-link" aria-label="Direct link to 设备模式验证" title="Direct link to 设备模式验证">​</a></h4>
<p>按以下步骤将设备配置为 USB 大容量存储设备：</p>
<ol>
<li>
<p>进入串口控制台：</p>
</li>
<li>
<p>配置 USB Gadget：</p>
<ul>
<li>进入 USB Gadget 配置目录：</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /config/usb_gadget/g2</span><br></span></code></pre></div></div>
<ul>
<li>创建大容量存储功能：</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir functions/mass_storage.0</span><br></span></code></pre></div></div>
<ul>
<li>在<code>/sdcard</code>创建 2GB ISO 文件：</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dd if=/dev/zero of=/sdcard/test.iso bs=1M count=2048</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.ext4 /sdcard/test.iso</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p><strong>ISO 文件位置</strong>：</p><p>ISO 文件<strong>必须</strong>创建在<code>/sdcard</code>目录下。其他目录会导致文件访问错误。</p><p><strong>错误示例</strong>（在非<code>/sdcard</code>目录创建）：</p><ul>
<li>Ubuntu dmesg 日志显示多次读取错误：</li>
</ul><p>[881331.266781] sd 5:0:0:0: [sdd] tag#0 FAILED Result: hostbyte=DID_OK driverbyte=DRIVER_SENSE
[881331.266782] sd 5:0:0:0: [sdd] tag#0 Sense Key : Medium Error [current]
[881331.266783] sd 5:0:0:0: [sdd] tag#0 Add. Sense: Unrecovered read error
[881331.287885] sdd: unable to read partition table</p><ul>
<li>
<p><strong>原因</strong>：USB Gadget 框架无法从非<code>/sdcard</code>目录读取 ISO 文件，可能是文件系统权限或 SELinux 限制。</p>
</li>
<li>
<p><strong>解决方法</strong>：始终使用<code>/sdcard/test.iso</code>创建 ISO 文件。</p>
</li>
</ul></div></div>
<ul>
<li>将 ISO 文件关联到大容量存储功能：</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;/sdcard/test.iso&quot; &gt; functions/mass_storage.0/lun.0/file</span><br></span></code></pre></div></div>
<ul>
<li>通过创建符号链接，将 <code>mass_storage.0</code> 功能绑定到配置 <code>b.1</code> 中。当该配置被激活时，设备会通过 USB 向主机提供大容量存储服务。</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ln -s functions/mass_storage.0/ configs/b.1/f1</span><br></span></code></pre></div></div>
<ul>
<li>启用 USB 设备控制器（UDC）：</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 8c00000.dwc3 &gt; UDC</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>切换到外设模式</strong>：</p>
<ul>
<li>设置 USB 模式为外设：</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo peripheral &gt; /sys/devices/platform/soc/8c00000.hsusb/mode</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>在主机 PC 上验证</strong>：</p>
<ul>
<li>
<p>在主机 PC 上运行 <code>lsusb</code>命令， 确认设备已正确连接：</p>
</li>
<li>
<p>预期输出：设备显示为<code>idVendor=0000</code>, <code>idProduct=0000</code>, <code>Manufacturer=QUALCOMM</code>, <code>Product=YUPIKP-IOT-IDP _SN:9F034665</code>。</p>
</li>
<li>
<p>运行 <code>dmesg</code>命令，验证设备信息。预期输出如下：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[881331.241987] sd 5:0:0:0: [sdd] 4194304 512-byte logical blocks: (2.15 GB/2.00 GiB)</span><br></span></code></pre></div></div>
<p>设备在主机 PC 上显示为 2.1 GB USB 磁盘，可访问和挂载（例如 Ubuntu 上的<code>/dev/sdd</code>）。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>错误分析：</p>
<ul>
<li>
<p><strong>症状</strong>：主机 PC 检测到 USB 磁盘但无法读取，<code>dmesg</code> 显示<code>Medium Error</code>和<code>Unrecovered read error</code>。</p>
</li>
<li>
<p><strong>原因</strong>：ISO文件创建在非<code>/sdcard</code>目录，导致 USB Gadget 框架无法访问。</p>
</li>
<li>
<p><strong>解决方法</strong>：在<code>/sdcard</code>重新创建 ISO 文件并重复配置步骤。</p>
</li>
</ul>
</blockquote></div></div>
</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="切换到主机模式">切换到主机模式<a href="#切换到主机模式" class="hash-link" aria-label="Direct link to 切换到主机模式" title="Direct link to 切换到主机模式">​</a></h4>
<ol>
<li>
<p>从设备上拔下 USB 线。</p>
</li>
<li>
<p>运行以下命令，设置 USB 控制器为主机模式：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo host &gt; /sys/devices/platform/soc/8c00000.hsusb/mode</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>验证</strong>：</p>
<ul>
<li>将 USB 设备（例如 U 盘）连接到 USB 2.0 TypeA 端口。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-73-740ae3a4267782d43a925d62dd02fbea.jpg" width="621" height="319" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>USB 2.0 Type-A 端口开机默认为主机模式。请确保使用正确端口进行主机模式验证。</p>
</blockquote></div></div>
<ul>
<li>运行以下命令，设备可检测连接到 USB Type-A 端口的外部 USB 设备（例如 U 盘）：</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /dev/sd*</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-31-type-c-接口">USB 3.1 Type-C 接口<a href="#usb-31-type-c-接口" class="hash-link" aria-label="Direct link to USB 3.1 Type-C 接口" title="Direct link to USB 3.1 Type-C 接口">​</a></h3>
<p>Type-C 接口可自动完成主机和设备模式的切换。</p>
<ul>
<li>
<p>当 Type-C 接入 PC 时自动切换为设备模式。</p>
</li>
<li>
<p>接入 OTG 线时自动切换为主机模式。</p>
</li>
<li>
<p>接入 DP 显示器时，自动输出 DP 视频信号。</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-调试">USB 调试<a href="#usb-调试" class="hash-link" aria-label="Direct link to USB 调试" title="Direct link to USB 调试">​</a></h3>
<p>本节提供有关获取调试日志的各种方法的信息。调试方式有 <code>regdumps</code> 、调试 <code>ftraces</code> 、 <code>configfs</code> 节点等。在调试与进入/退出低功耗模式、SMMU 故障、无时钟访问相关的问题时，可通过上述日志查看事件和控制器状态的详细信息。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="usb-跟踪">USB 跟踪<a href="#usb-跟踪" class="hash-link" aria-label="Direct link to USB 跟踪" title="Direct link to USB 跟踪">​</a></h4>
<p>使用 <code>debugfs</code> 跟踪可以更加深入地了解 USB 线上发生的每一个事务。如需查看跟踪列表，可运行以下命令。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>确保已挂载 <code>debugfs</code>。</p>
<p>使用<code>mount | grep /sys/kernel/debug</code>检查是否已经挂载。</p>
<p>如果尚未挂载，可运行以下命令来挂载 <code>debugfs</code>:</p>
<p><code>mount -t debugfs none /sys/kernel/debug</code></p>
</blockquote></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/dwc3</span><br></span></code></pre></div></div>
<p>以下是可用于验证 xHCI/gadget 协议栈/USB Type-C 连接器系统软件接口 (UCSI) 中的数据传输的跟踪。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_alloc_request  dwc3_event              dwc3_gadget_generic_cmd  enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_complete_trb   dwc3_free_request       dwc3_gadget_giveback     filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ctrl_req       dwc3_gadget_ep_cmd      dwc3_prepare_trb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ep_dequeue     dwc3_gadget_ep_disable  dwc3_readl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ep_queue       dwc3_gadget_ep_enable   dwc3_writel</span><br></span></code></pre></div></div>
<p>要列出 xHCI/主机控制器驱动程序 (HCD) 中的跟踪数据，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/xhci-hcd</span><br></span></code></pre></div></div>
<p>以下是可用于验证 xHCI/HCD 中数据传输的跟踪。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable                            xhci_handle_cmd_config_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filter                            xhci_handle_cmd_disable_slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_add_endpoint                 xhci_handle_cmd_reset_dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_address_ctrl_ctx             xhci_handle_cmd_reset_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_address_ctx                  xhci_handle_cmd_set_deq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_alloc_dev                    xhci_handle_cmd_set_deq_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_alloc_virt_device            xhci_handle_cmd_stop_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_configure_endpoint           xhci_handle_command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_configure_endpoint_ctrl_ctx  xhci_handle_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_alloc_request            xhci_handle_port_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_free_request             xhci_handle_transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_gadget_ep_queue          xhci_hub_status_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_giveback_request         xhci_inc_deq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_handle_event             xhci_inc_enq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_handle_transfer          xhci_queue_trb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_queue_request            xhci_ring_alloc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_address                  xhci_ring_ep_doorbell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_cancel_urb               xhci_ring_expansion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_context_change           xhci_ring_free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_init                     xhci_ring_host_doorbell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_quirks                   xhci_setup_addressable_virt_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_reset_ep                 xhci_setup_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_ring_expansion           xhci_setup_device_slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_discover_or_reset_device     xhci_stop_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_free_dev                     xhci_urb_dequeue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_free_virt_device             xhci_urb_enqueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_get_port_status              xhci_urb_giveback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_handle_cmd_addr_dev</span><br></span></code></pre></div></div>
<p>请运行以下命令，以便列出 USB 视频类 (UVC) gadget 驱动程序的可用事件。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/gadget</span><br></span></code></pre></div></div>
<p>随即显示以下输出。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable                      usb_gadget_activate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filter                      usb_gadget_clear_selfpowered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_alloc_request        usb_gadget_connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_clear_halt           usb_gadget_deactivate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_dequeue              usb_gadget_disconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_disable              usb_gadget_frame_number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_enable               usb_gadget_giveback_request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_fifo_flush           usb_gadget_set_remote_wakeup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_fifo_status          usb_gadget_set_selfpowered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_free_request         usb_gadget_vbus_connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_queue                usb_gadget_vbus_disconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_halt             usb_gadget_vbus_draw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_maxpacket_limit  usb_gadget_wakeup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_wedge</span><br></span></code></pre></div></div>
<p>如需列出 UCSI 驱动程序中的可用事件，可运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/ucsi</span><br></span></code></pre></div></div>
<p>随即显示以下输出。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable  ucsi_connector_change  ucsi_register_port  ucsi_run_command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filter  ucsi_register_altmode  ucsi_reset_ppm</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="主机-sysfs-查询">主机 sysfs 查询<a href="#主机-sysfs-查询" class="hash-link" aria-label="Direct link to 主机 sysfs 查询" title="Direct link to 主机 sysfs 查询">​</a></h4>
<p>要查看总线详细信息，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lsusb</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Bus 005 Device 001: ID 1d6b:0003  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 003 Device 001: ID 1d6b:0003  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 001 Device 001: ID 1d6b:0002  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 006 Device 001: ID 1d6b:0002  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 004 Device 001: ID 1d6b:0002  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 007 Device 003: ID 0b95:1790  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 002 Device 001: ID 1d6b:0002  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 007 Device 001: ID 1d6b:0003  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>请运行以下命令，以便列出当前目录的内容。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/bus/usb/devices/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1-0:1.0  3-0:1.0  5-0:1.0  7-0:1.0  7-3:1.0  usb2  usb4  usb6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2-0:1.0  4-0:1.0  6-0:1.0  7-3      usb1     usb3  usb5  usb7</span><br></span></code></pre></div></div>
<p>要查看有关 USB 设备的详细信息，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/devices</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=01 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480  MxCh= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0002 Rev= 5.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 5.4.233-qgki-debug dummy_hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=Dummy host controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=dummy_hcd.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=02 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480  MxCh= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0002 Rev= 5.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 5.4.233-qgki-debug xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=xhci-hcd.2.auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=03 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=5000 MxCh= 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 3.00 Cls=09(hub  ) Sub=00 Prot=03 MxPS= 9 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0003 Rev= 5.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 5.4.233-qgki-debug xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=xhci-hcd.2.auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=(none)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=04 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480  MxCh= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0002 Rev= 5.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 5.4.233-qgki-debug xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=xhci-hcd.3.auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=05 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=5000 MxCh= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 3.00 Cls=09(hub  ) Sub=00 Prot=03 MxPS= 9 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0003 Rev= 5.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 5.4.233-qgki-debug xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=xhci-hcd.3.auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=06 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480  MxCh= 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0002 Rev= 5.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 5.4.233-qgki-debug xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=0000:01:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=07 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=5000 MxCh= 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 3.00 Cls=09(hub  ) Sub=00 Prot=03 MxPS= 9 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0003 Rev= 5.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 5.4.233-qgki-debug xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=0000:01:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=07 Lev=01 Prnt=01 Port=02 Cnt=01 Dev#=  3 Spd=5000 MxCh= 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 3.20 Cls=ff(vend.) Sub=ff Prot=00 MxPS= 9 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=0b95 ProdID=1790 Rev= 2.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=ASIX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=AX88179B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=00536055</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=a0 MxPwr=184mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 4 Cls=ff(vend.) Sub=ff Prot=00 Driver=ax_usb_nic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=  16 Ivl=128ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=82(I) Atr=02(Bulk) MxPS=1024 Ivl=0ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=03(O) Atr=02(Bulk) MxPS=1024 Ivl=0ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=05(O) Atr=02(Bulk) MxPS=1024 Ivl=0ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="相机串行接口-csi">相机串行接口 （CSI）<a href="#相机串行接口-csi" class="hash-link" aria-label="Direct link to 相机串行接口 （CSI）" title="Direct link to 相机串行接口 （CSI）">​</a></h2>
<p>目前，RUBIK Pi 3与<a href="https://www.thundercomm.com/rubik-pi-3/cn/docs/peripheral-compatibility-list" target="_blank" rel="noopener noreferrer">外设兼容列表</a>中列出的相机模块兼容。下表列出了每个相机模块支持的分辨率。</p>
<table><thead><tr><th>分辨率</th><th>宽高比</th><th>IMX477</th><th>IMX708</th><th>IMX219</th></tr></thead><tbody><tr><td>4056 x 3040</td><td>4:3</td><td>是</td><td>否</td><td>否</td></tr><tr><td>4608 x 2592</td><td>16:9</td><td>否</td><td>是</td><td>否</td></tr><tr><td>3280 x 2464</td><td>4:3</td><td>否</td><td>否</td><td>是</td></tr><tr><td>1920 x 1080</td><td>16:9</td><td>是</td><td>否</td><td>否</td></tr><tr><td>1632 x 1224</td><td>4:3</td><td>否</td><td>否</td><td>是</td></tr></tbody></table>
<ul>
<li>
<p>HQ Camera（IMX477/M12 Mount）</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155508-d8f6e66fed4ad19156dd150680d0494f.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
<li>
<p>Camera Module 2 (IMX219)</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>目前 RUBIK Pi 3 暂时只支持标准版 Module 2 摄像头，不支持广角（Wide）、夜光（NoIR）版本。</p>
</blockquote></div></div>
</li>
<li>
<p>Camera Module 3 (IMX708)</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>目前 RUBIK Pi 3 暂时只支持标准版 Module 3 摄像头，不支持广角（Wide）、夜光（NoIR）版本。当前软件版本暂不支持 Module 3 摄像头的 AF 自动对焦功能。</p>
</blockquote></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="摄像头排线安装">摄像头排线安装<a href="#摄像头排线安装" class="hash-link" aria-label="Direct link to 摄像头排线安装" title="Direct link to 摄像头排线安装">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>严禁在板子未断电的情况下插拔摄像头，否则非常容易烧坏摄像头模组。</p></div></div>
<p>RUBIK Pi 3 支持的摄像头 FPC 为 22 pin，0.5mm 间距，厚度 0.3±0.05mm。兼容的附件请参考<a href="https://www.thundercomm.com/rubik-pi-3/cn/docs/peripheral-compatibility-list" target="_blank" rel="noopener noreferrer">外设兼容列表</a>。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155515-709f9580e8ce95ebbc7bb79228b62a36.jpg" width="1000" height="750" class="img_ev3q"></p>
<ol>
<li>
<p>向上拉开连接器的锁扣部分：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155519-db8183a9be1bbba68e5132d22017d18b.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
<li>
<p>插入 FPC，注意接触面朝向板内：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155503-74b2a4642754226940b7e16ac07e696a.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
<li>
<p>按下锁扣，确认 FPC 稳定没有松动：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155500-130370946aa496911ecb03dcdc375a11.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="摄像头使用方法">摄像头使用方法<a href="#摄像头使用方法" class="hash-link" aria-label="Direct link to 摄像头使用方法" title="Direct link to 摄像头使用方法">​</a></h3>
<p>打开骁龙相机app或者相机：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAA0JCgsKCA0LCgsODg0PEyAVExISEyccHhcgLikxMC4pLSwzOko+MzZGNywtQFdBRkxOUlNSMj5aYVpQYEpRUk//2wBDAQ4ODhMREyYVFSZPNS01T09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0//wAARCADbAWYDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD0aiiimMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooCs3QD8aXy39qAEopfLf1FHlv6igBKKXy39RR5b+ooASil8t/UUeW/qKAEopfLf1FHlv7UAJRSex60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Gn3L+ZHJEuSp967ijAPBoA5G3vNV1/Xrea3jubLToBl9/wAplP0qhej+z/GV3e6vp0t7byqBbssfmBenau8paAOD8NiZvG9zcPp8lpDNCTGpj2gDjHTjNXfBcE0Ot6+0sUiK9xlSykBvmbpXX8ZooA5Hw5DNH4y1ySSKRUdhtYqQG57Gm2tpK/xB1JnikEMluF37Tg/KB1rsKBx3oA85sLWDQLi4tNZ0RrpGkLRTrFvyPSt+zSObQdTkt9HFgJI2WMBAGkGOuBXTYBHNLQBzngWKWLwnBHLG8cgaThlII+Y9q5/SnXSr29j1XRpru9llJjk8rfuHsT0r0Ok/CgTRxnw8huIDqiXVs8DtMrbShUd+ldpSUtAwooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q==" width="358" height="219" class="img_ev3q"></p>
<p>骁龙相机</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="344" height="232" class="img_ev3q"></p>
<p>普通相机</p>
<p>可将摄像头插入，下图 13 和 14 处</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-81-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<p>如下为实物连接图：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155452-0b5aceedff3518e98aa028798281a825.jpg" width="1000" height="750" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>暂时无法支持两个 IMX708 4608x2592同时运行。</p>
</blockquote></div></div>
<p>预览结果如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/img_v3_02jm_58744e49-6711-40d8-b572-46153b40191g-b2fc175bb45164408dbe2fd250d13d61.jpg" width="1000" height="571" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>支持两摄像头并发预览</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out">HDMI OUT<a href="#hdmi-out" class="hash-link" aria-label="Direct link to HDMI OUT" title="Direct link to HDMI OUT">​</a></h2>
<p>RUBIK Pi 3 的 HDMI 接口为下图 9。</p>
<p>RUBIK Pi 3 HDMI 参数信息：</p>
<ul>
<li>
<p>HDMI 1.4</p>
</li>
<li>
<p>3840 x 2160 分辨率 @ 30 fps</p>
</li>
<li>
<p>DSI 0 to HDMI (LT9611)</p>
</li>
<li>
<p>支持 CEC</p>
</li>
<li>
<p>支持分辨率自适应</p>
</li>
<li>
<p>支持热插拔</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-78-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>DP 和 HDMI 可同时接显示器，并发显示。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out-触摸屏">HDMI OUT 触摸屏<a href="#hdmi-out-触摸屏" class="hash-link" aria-label="Direct link to HDMI OUT 触摸屏" title="Direct link to HDMI OUT 触摸屏">​</a></h3>
<p>RUBIK Pi 3 默认支持 1024*600P 分辨率的 HDMI OUT 触摸屏，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/img_v3_02lq_08dab183-6f5d-477a-af1d-dcbbc7e1d07g-3f4bbe760cb5ab6a7f439e924fd3b738.jpg" width="1000" height="750" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>上图中使用的屏幕为 <a href="https://detail.tmall.com/item.htm?abbucket=12&amp;id=683025543197&amp;rn=92499216a472de3107f9541a1b160dc3&amp;spm=a1z10.5-b-s.w4011-25285306736.152.50aa1c712FMfOS&amp;skuId=5055110246880" target="_blank" rel="noopener noreferrer">7 寸 IPS 高清触摸屏幕</a>。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out-调试">HDMI OUT 调试<a href="#hdmi-out-调试" class="hash-link" aria-label="Direct link to HDMI OUT 调试" title="Direct link to HDMI OUT 调试">​</a></h3>
<p>RUBIK Pi 3 使用的是 LT9611 这款 DSI-to-HDMI 桥接芯片。</p>
<p>下表列 HDMI 桥接芯片所需的配置。</p>
<table><thead><tr><th>说明</th><th>DTSI 节点</th></tr></thead><tbody><tr><td>将 DSI-to-HDMI 桥接面板设置为 Primary</td><td><code>&amp;sde_dsi { qcom, dsi-default-panel = &lt;&amp;dsi_ext_bridge_1080p&gt;;</code></td></tr><tr><td>为桥接芯片配置基准电源条目</td><td><code>&amp;sde_dsi { vddio-supply = &lt;&amp;vreg_18c_ip62&gt;; vdda-9p9-supply = &lt;&amp;vreg_11oc_9p88&gt;; vdda-9p9-supply = &lt;&amp;vreg_11oc_9p88&gt;;</code></td></tr><tr><td>为桥接芯片配置面板复位 GPIO</td><td><code>lt9611: lt,lt9611 { reset-options = &lt;&amp;tlmm 21 0&gt;;}</code></td></tr><tr><td>在外部桥接模式下配置 DSI 主机驱动程序以使用第三方 DSI-to-HDMI 桥接芯片</td><td><code>qcom,mdss-dsi-ext-bridge-mode;</code></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-lt9611-日志">获取 LT9611 日志<a href="#获取-lt9611-日志" class="hash-link" aria-label="Direct link to 获取 LT9611 日志" title="Direct link to 获取 LT9611 日志">​</a></h4>
<p>要获取LT9611 日志，请运行以下命令：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg | grep lt9611</span><br></span></code></pre></div></div>
<p>查看 log，出现下面的字样代表 HDMI OUT 可以正常运行。</p>
<p>HDMI OUT能否正常运行取决于几个关键条件是否满足。以下是关键字样及其含义：</p>
<ul>
<li>
<p><strong>read edid succeeded</strong>
表示成功读取显示器EDID，这是HDMI信号输出的基础条件。</p>
</li>
<li>
<p><strong>HDMI pll locked</strong>
表示PLL锁定，时钟信号稳定，是视频信号正常传输的关键。</p>
</li>
<li>
<p><strong>bridge enable</strong>
表示桥接功能启用，芯片开始处理和输出HDMI信号。</p>
</li>
<li>
<p><strong>video check </strong>
查看显示与设置是否一致，如h_act_a=1920, v_act=1080，表示视频信号参数正确。</p>
</li>
<li>
<p><strong>connector.status(2) hpd_status(1)</strong>
表示连接器检测到设备（HPD=1），状态正常。</p>
</li>
<li>
<p><strong>[name=HDMI-A-1]:[status=connected]</strong>
表示HDMI接口已连接到显示器。</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-dsi-日志">获取 DSI 日志<a href="#获取-dsi-日志" class="hash-link" aria-label="Direct link to 获取 DSI 日志" title="Direct link to 获取 DSI 日志">​</a></h4>
<p>我们也可以通过输出的 DSI 信息进行调试，DSI 指的是 Display Serial Interface（显示串行接口），通常与移动设备或嵌入式系统的显示驱动（如 MIPI DSI）相关。</p>
<p>这个命令用来查看与显示接口（DSI）相关的内核日志，通常用于调试显示驱动或硬件问题。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg | grep dsi</span><br></span></code></pre></div></div>
<p>结合DSI log和之前的LT9611 log，DSI显示功能的正常运行需要以下条件：</p>
<ul>
<li>
<p><strong>DSI控制器和PHY初始化成功</strong>：log中显示DSI PHY和控制器最终探测成功（Probe successful）。</p>
</li>
<li>
<p><strong>PLL注册成功</strong>：DSI PLL成功注册（Registered DSI PLL ndx=0），确保时钟信号正常。</p>
</li>
<li>
<p><strong>外部桥接绑定成功</strong>：DSI成功绑定到LT9611桥接（Successfully bind display panel）。</p>
</li>
<li>
<p><strong>显示模式正确设置</strong>：1920x1080@60Hz模式设置成功，且与LT9611的视频检查参数一致。</p>
</li>
<li>
<p><strong>LT9611桥接正常工作</strong>：从LT9611 log可知，EDID读取成功、PLL锁定、桥接启用、HDMI连接状态为connected。</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取显示面板信息">获取显示面板信息<a href="#获取显示面板信息" class="hash-link" aria-label="Direct link to 获取显示面板信息" title="Direct link to 获取显示面板信息">​</a></h4>
<p>若要查看选定的显示面板，请运行以下命令（以1080p为例）：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug//sys/kernel/debug/qcom,mdss_dsi_ext_bridge_1080p/dump_info</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name = qcom,mdss_dsi_ext_bridge_1080p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Resolution = 1920x1080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CTRL_0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ctrl = dsi-ctrl-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                phy = dsi-phy-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Panel = ext video mode dsi bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Clock master = dsi-ctrl-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-dsi-时钟信息">获取 DSI 时钟信息<a href="#获取-dsi-时钟信息" class="hash-link" aria-label="Direct link to 获取 DSI 时钟信息" title="Direct link to 获取 DSI 时钟信息">​</a></h4>
<p>若要检查 DSI 时钟信息(以1080p为例)，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/qcom,mdss_dsi_ext_bridge_1080p/dsi-ctrl-0/state_info</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Current State:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CTRL_ENGINE = OFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        VIDEO_ENGINE = OFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        COMMAND_ENGINE = OFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Clock Info:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BYTE_CLK = 111375000, PIXEL_CLK = 148500000, ESC_CLK = 19200000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取调压器信息">获取调压器信息<a href="#获取调压器信息" class="hash-link" aria-label="Direct link to 获取调压器信息" title="Direct link to 获取调压器信息">​</a></h4>
<p>要检查调压器状态和电压，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/regulator/regulator_summary</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取接口信息">获取接口信息<a href="#获取接口信息" class="hash-link" aria-label="Direct link to 获取接口信息" title="Direct link to 获取接口信息">​</a></h4>
<p>要检索调试 dump 输出（显示接口编号、VSync 计数、欠载计数和接口模式），请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/dri/0/encoder*/status</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">intf:1    vsync:  359036     underrun:       0    mode: video</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intf:0    vsync:       0     underrun:       0    mode: video</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取常规-dpu-调试信息">获取常规 DPU 调试信息<a href="#获取常规-dpu-调试信息" class="hash-link" aria-label="Direct link to 获取常规 DPU 调试信息" title="Direct link to 获取常规 DPU 调试信息">​</a></h4>
<p>常见的 DPU 调试信息说明如下：</p>
<p>要检查 DPU 时钟速率，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/clk/clk_summary | grep disp_cc</span><br></span></code></pre></div></div>
<p>将 DPU 设置为性能模式</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/kernel/debug/dri/0/debug/core_perf/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; perf_mode</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="displayport">DisplayPort<a href="#displayport" class="hash-link" aria-label="Direct link to DisplayPort" title="Direct link to DisplayPort">​</a></h2>
<p>RUBIK Pi 3 拥有 1 个 USB Type-C (SST) 接口的 DisplayPort，如下图5。</p>
<p>DP 的参数如下：</p>
<ul>
<li>
<p>3840 × 2160 分辨率 @ 60 fps</p>
</li>
<li>
<p>单流传输 (Single stream transport)</p>
</li>
<li>
<p>DisplayPort 和 USB 3.0 的并发功能</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-77-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>DP 和 HDMI 可同时接显示器，并发显示。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dp-调试">DP 调试<a href="#dp-调试" class="hash-link" aria-label="Direct link to DP 调试" title="Direct link to DP 调试">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-dp-日志">获取 DP 日志<a href="#获取-dp-日志" class="hash-link" aria-label="Direct link to 获取 DP 日志" title="Direct link to 获取 DP 日志">​</a></h4>
<p>输入下面命令开启日志打印权限。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 8 &gt; /proc/sys/kernel/printk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo ‘file dsi* +p’ &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>第一条命令中的<code>8</code>表示日志级别。Linux 内核用 0 到 8 表示日志的优先级，数值越小，优先级越高：</p>
<ul>
<li>
<p>0 (KERN_EMERG): 系统紧急情况（比如崩溃）。</p>
</li>
<li>
<p>1 (KERN_ALERT): 需要立即处理的问题。</p>
</li>
<li>
<p>2 (KERN_CRIT): 严重错误。</p>
</li>
<li>
<p>3 (KERN_ERR): 一般错误。</p>
</li>
<li>
<p>4 (KERN_WARNING): 警告。</p>
</li>
<li>
<p>5 (KERN_NOTICE): 正常但值得注意的事件。</p>
</li>
<li>
<p>6 (KERN_INFO): 信息性消息。</p>
</li>
<li>
<p>7 (KERN_DEBUG): 调试信息。</p>
</li>
<li>
<p>8: 比调试还低的级别，可以打出全部级别。</p>
</li>
</ul>
</blockquote></div></div>
<p>而<code>echo ‘file dsi* +p’ &gt; /sys/kernel/debug/dynamic_debug/control</code>则会显示内核中所有文件名以 <em>dsi*</em> 开头的源文件（通常是 DSI 显示驱动相关的代码）里的调试信息。这些调试信息会输出到内核日志，可以通过 <code>dmesg</code> 查看。通过下面的命令输出来调试 DP：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mount -t debugfs none /sys/kernel/debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_display.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_aux.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_link.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_power.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_ctrl.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_parser.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span></code></pre></div></div>
<p>打开全部的限制等级之后，关于 DP 功能是否正常运行的判断需要以下条件：</p>
<ul>
<li>
<p><strong>DP控制器初始化成功</strong>：DP 组件绑定到DRM框架，主机初始化完成。</p>
</li>
<li>
<p><strong>PLL和时钟配置正常</strong>：PLL 初始化成功，时钟资源可用。</p>
</li>
<li>
<p><strong>链路训练成功</strong>：DP 链路训练完成，确保物理层通信正常。</p>
</li>
<li>
<p><strong>HPD检测到连接</strong>：显示器连接状态为 connected，触发 HPD 事件。</p>
</li>
<li>
<p><strong>分辨率和模式设置正确</strong>：分辨率、分辨率参数与显示器能力匹配。</p>
</li>
</ul>
<p>关键字样及其含义：</p>
<ul>
<li>
<p><strong>msm_drm ... bound ... qcom,dp_display</strong>：表示 DP 控制器成功绑定到 DRM 框架。</p>
</li>
<li>
<p><strong>dp_display_host_init ... [OK]</strong> 和 <strong>dp_display_host_ready ... [OK]</strong>：表示 DP 主机初始化和准备完成。</p>
</li>
<li>
<p><strong>dp_ctrl_link_train ... successful</strong>：表示链路训练成功，物理层通信正常。</p>
</li>
<li>
<p><strong>[name=DP-1]:[status=connected]</strong>：表示 DP 接口检测到显示器连接。</p>
</li>
<li>
<p><strong>dp_panel_resolution_info ... 1920x1080@60fps</strong>：表示分辨率设置正确。</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wi-fi--蓝牙">Wi-Fi &amp; 蓝牙<a href="#wi-fi--蓝牙" class="hash-link" aria-label="Direct link to Wi-Fi &amp; 蓝牙" title="Direct link to Wi-Fi &amp; 蓝牙">​</a></h2>
<p>RUBIK Pi 3 上搭载了AP6256 Wi-Fi 模块，支持 Wi-Fi 5 和蓝牙 5.2。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wi-fi">Wi-Fi<a href="#wi-fi" class="hash-link" aria-label="Direct link to Wi-Fi" title="Direct link to Wi-Fi">​</a></h3>
<p>Wi-Fi 是一种使用 IEEE 802.11 协议的无线网络技术。它允许智能手机、可穿戴设备、笔记本电脑、台式机和其他消费电子产品等电子设备在没有物理电缆的情况下连接到互联网。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="工作频段">工作频段<a href="#工作频段" class="hash-link" aria-label="Direct link to 工作频段" title="Direct link to 工作频段">​</a></h4>
<p> AP6256 Wi-Fi 模块支持 2.4 GHz、5 GHz 工作频段。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="工作模式">工作模式<a href="#工作模式" class="hash-link" aria-label="Direct link to 工作模式" title="Direct link to 工作模式">​</a></h4>
<p>Wi-Fi 软件在以下模式下运行：</p>
<table><thead><tr><th>模式</th><th>说明</th></tr></thead><tbody><tr><td>STA 模式</td><td>在 STA 模式下，设备连接到 Wi-Fi 网络中的接入点，并与网络中的其他设备进行通信。此模式是 Wi-Fi 连接中的无线设备的标准模式。</td></tr><tr><td>热点模式</td><td>热点模式使设备能够使用蜂窝链路 (LTE) 向 Wi-Fi 客户端提供回程 (Internet) 连接。该设备通过其轻量级热点接口建立此连接。在热点模式下，设备可以与连接到同一热点的其他 Wi-Fi 客户端通信，与热点设备通信，共享设备的 WAN 连接。</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="sta-模式">STA 模式<a href="#sta-模式" class="hash-link" aria-label="Direct link to STA 模式" title="Direct link to STA 模式">​</a></h5>
<p>在 STA 模式（Station）下，设备可连接到一个已经存在的无线网络，以便访问网络资源或互联网，在 RUBIK Pi 3 中进行如下操作：</p>
<ol>
<li>打开设置。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-80-dbf23d1ad905e3ec9add27d856b4d80b.jpg" width="1000" height="256" class="img_ev3q"></p>
<ol start="2">
<li>进入网络设置。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-82-0957c7859cf87932a54c4dbe6276491e.jpg" width="1000" height="406" class="img_ev3q"></p>
<ol start="3">
<li>选取适合的网络进行连接。</li>
</ol>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAA0JCgsKCA0LCgsODg0PEyAVExISEyccHhcgLikxMC4pLSwzOko+MzZGNywtQFdBRkxOUlNSMj5aYVpQYEpRUk//2wBDAQ4ODhMREyYVFSZPNS01T09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0//wAARCAEZA+gDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD0aiiimMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAPN/jB/qtJ+s3/ALJRR8YP9VpP1m/9kopCPSKKKKYwooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA83+MH+q0n6zf+yUUfGD/VaT9Zv/AGSikI9IooopjCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDzf4wf6rSfrN/7JRR8YP8AVaT9Zv8A2SikI9IooopjCiisLw74iGuXF9ELUwfZHCZL7t2SR6cdKAN2iiigAopKp6bqtjqqStYTiYRNscgEYPpzQBdooooAKKKKACiiigAooooAKKKq6hqFrplo11fSiKFSAWIJ5PTpQBaoqOCWOeCOaJt0cihlPqDyKkoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAPN/jB/qtJ+s3/slFHxg/wBVpP1m/wDZKKQj0iii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zpn/AF7J/KtSgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK4Hxdfvdaq1sGPk2/ygerdz/Su+rzTX4mh1y8Vx1kLD6HmtqKXMRU2M6iiiuoxCui8L6RFdlry5UPGjbUQ9CfU1ztdr4QnR9LaEH54pDkex5BqZuyHHc3QAq7VAAHYVgeJdIiltXvbdAk8Q3NtGN47/jXQVT1idLfSrmRyMeWVHuTwKyT1LY3wzfvf6QjStuliPlufXHQ/lWvXN+CImTSppG6SS/L+AArpKxqK0nY0jseb/GD/VaT9Zv/AGSij4wf6rSfrN/7JRWYHpFFFFMYVUstOtLB7l7WLY11KZZTknc39PpVuigCpaadaWd1dXNvFslu3DzNkncR/KnWVjb2KSrbIVEsrTPlics3U81ZooArT2NvPe213KhM1ru8ohiANwweO9TTRJPDJDIMpIpVhnGQRg0+igCG0torO0itbdSsUKBEBOcAdOamoooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACsHxLoR1NFuLbAuYxjB4Dj0+tb1FOMnF3QmrnlE8E1tIY7iJ43HUMMVFkeo/OvWnRJBh0Vh/tDNM+zW/wDzwi/74H+FdCr+Rn7M8oyPUfnVixvprC4E9tIFYcEHow9DXp/2a3/54Rf98D/Cj7Nb/wDPCL/vgf4Ue3XYPZs5JPGI8v57PL/7MnFQiPVfE1wm9DBaKc5wQo/+KNdmLeAHIgiH/ABUlR7VdEPkfUitbaK0to7eBdsca4AqaiisdzQ83+MH+q0n6zf+yUUfGD/VaT9Zv/ZKKQj0iiiimMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAPN/jB/qtJ+s3/ALJRR8YP9VpP1m/9kopCPSKKKKYwooooAKKKKACiiigAopKKAFopKKAFopKKAFopKWgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDzf4wf6rSfrN/7JRR8YP9VpP1m/8AZKKQj0iiiimMKinuILZN9xNHEvq7Afzqrrc95baVPNp8YknUZAPOB3IHcj0ryq5uZ7uYzXMryyN1Zzk0wPWYdSsLhtsN7bu3osgzVuvF1G51HTJAzXqGh2dzYF7aXVVvEjA/dlfnj9Oc5x7GgVzYooopDIpeoqMk46mnznBFQs3B4oAMn1P509ScdTUHm+1PWXjpQBMDz1p1QGbbzt/Wk+0/7H60ATZPrRk+tVTeDP3D+dMe/C4/dk/jQBdyfU0ZPrVD+0R/zyP/AH1S/wBoD/nkfzoA0V6UN0qK1l86LftxyRiluZPKhL4zjtQA6oyTk8mqv9oD/nkfzpwuNwzt6+9AE+T6mjJ9TVdrnb/B+tJ9r/2D+dAF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" width="1000" height="281" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="无线模式">无线模式<a href="#无线模式" class="hash-link" aria-label="Direct link to 无线模式" title="Direct link to 无线模式">​</a></h5>
<ol>
<li>打开网络设置。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-74-66330844b1a335ffa881e9661efc793b.jpg" width="1000" height="303" class="img_ev3q"></p>
<ol start="2">
<li>进入热点设置。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-76-c1cf75a73e8011cdb51842d50791c3f9.jpg" width="1000" height="207" class="img_ev3q"></p>
<ol start="3">
<li>选择 Wi-Fi 热点。功能</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-75-17d19c80111ecb33b4a9d1c4573f920c.jpg" width="1000" height="432" class="img_ev3q"></p>
<ol start="4">
<li>打开热点，并设置下面属性。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-96-d44d1e9b90dd1b8a7b2b054865817241.jpg" width="1000" height="514" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="蓝牙">蓝牙<a href="#蓝牙" class="hash-link" aria-label="Direct link to 蓝牙" title="Direct link to 蓝牙">​</a></h3>
<p>蓝牙® 无线技术是一种短距离通信系统，可实现设备之间的无线数据交换。蓝牙技术的主要优势如下：</p>
<ul>
<li>
<p>替代便携式和固定式电子设备的线缆</p>
</li>
<li>
<p>提供稳健、节能且经济高效的解决方案</p>
</li>
<li>
<p>促进解决方案及其应用的灵活性。</p>
</li>
</ul>
<p>在 RUBIK Pi 3 中使用下面命令测试蓝牙功能</p>
<ol>
<li>设置中搜索 Bluetooth</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-97-ce149f448f9e197f48d50a48751ec0ee.jpg" width="1000" height="423" class="img_ev3q"></p>
<p>2. 进入到功能界面</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-94-ce57afd287ad2c22d90188c07aa49fc5.jpg" width="1000" height="419" class="img_ev3q"></p>
<ol start="3">
<li>进入配对模式连接</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-99-887e07c57c5852f6f0658436c982efbc.jpg" width="1000" height="370" class="img_ev3q"></p>
<p>配对成功就可以正常使用蓝牙功能了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="音频">音频<a href="#音频" class="hash-link" aria-label="Direct link to 音频" title="Direct link to 音频">​</a></h2>
<p>RUBIK Pi 3 目前支持的音接口为：</p>
<ul>
<li>
<p>3.5mm 耳机，下图4。</p>
</li>
<li>
<p>HDMI OUT， 下图9。</p>
</li>
<li>
<p>蓝牙</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-91-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看声卡信息">查看声卡信息<a href="#查看声卡信息" class="hash-link" aria-label="Direct link to 查看声卡信息" title="Direct link to 查看声卡信息">​</a></h3>
<ul>
<li>
<p>在 RUBIK Pi 3 中输入下面命令，查看声卡挂载情况：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/asound/cards</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-95-dc676fd705f32566d3d806e5119764ab.jpg" width="770" height="98" class="img_ev3q"></p>
</li>
<li>
<p>在 RUBIK Pi 3 中输入下面命令，查看已分配的 pcm 流列表：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/asound/pcm</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-93-fe9c5b1ea6d10825fa2863bce7890c09.jpg" width="621" height="445" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="录制">录制<a href="#录制" class="hash-link" aria-label="Direct link to 录制" title="Direct link to 录制">​</a></h3>
<ul>
<li>
<p>在 RUBIK Pi 3 中进行如下操作测试耳机录制。 </p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>仅支持外接的 3.5mm 耳机的 mic 进行收音。</p>
</blockquote></div></div>
<ol>
<li>使用录音软件录音。</li>
</ol>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAA0JCgsKCA0LCgsODg0PEyAVExISEyccHhcgLikxMC4pLSwzOko+MzZGNywtQFdBRkxOUlNSMj5aYVpQYEpRUk//2wBDAQ4ODhMREyYVFSZPNS01T09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0//wAARCADrAUUDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD0aiiimMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKSigBaKTNGaAFopM0ZoAWikzRmgBaKTNGaAFopKWgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAVS7Y/OpfKT0pkP3mqakIZ5Sf3aPKT+7T6KAGeUn92jyk/u0+igBnlJ/do8pP7tPooAZ5Sf3aPKT+7T6KAI2iGMqMGohzVmqwpgLRRRQMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiikoAfD95qmqGH7zfhU1IQVHNNHBGZJnCIvUmnswVSzHAHJNcHruqvqN0VRiLdDhB6+9ROaijow+HlXlZbGrfeKwGKWMWR/ff/Csp/EOqSHIuNnsqisuiuR1ZM9yngqMFtc2rfxPqETDzNkq98jBNdFpeu2t+RGf3Ux/hbv8ASuCpQSpBUkEdxTjWktyKuApTWisz1GisPw3qzXsJt7hszxjr/eFbldkZKSujwqtOVKTjIKrLVmqy1SMxaKKKBhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUlLSUAPh+834VNUMP3m/CpqQjH8UXTW+kMEOGlYJ+HU/y/WuGrq/Ge7yLXH3dzZ+uBj+tc9pkcMl9El0R5RPzZOK5K2srHu5elCg5lXrVq2sjJJMkweMxwtJgjBOBmnRPbt4cluFRPtCXgQZPO3j9Oa1Lv/kYrsdv7OJ/8dpKn3LqYu8Xy+ZhmCUWkVyUIilJCN6kVHW1AqtoGiKwBBuGBB/3mqK/jtVvtVWQAOjDyQDjnPPFKVO2xVLFc1+Zf1exV0q5a01GGUHjcAfcGvRVOQD615gmS4A654r0yHPkR567R/KtcO90ceaRV4yJKrLVmqy10o8kWiiigYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFJS0UAOh+834VNUMP3m/CpqQjI8TWpudIcoMtEwkx7Dr+hrhe9eoEAggjINcNr2kPYXDSRKTbucqf7vtXNXhf3j1strpXps5+e358yPgg5xV211eQ3s1zeZd5LdoRtGMZGBUdRSRA8qMGsIzaPRqUYyJzfyyafb2RAVIGLKw65Jz/AFpmSzFmJZj1JNRqKlVWZgqgkngAUSk2VTpxhsi5pNsbvUoYgON2T9BXogGAB6Vi+HNKNjAZph++kHT+6K266qMOVaniY+uqtS0dkFVlqzVZa3RwoWiiigYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFJQA+H7zfhU1Qw/eb8KmpCCmSRpLGY5FDKRgg0+igL2Obv/CscjF7KTyyf4G5H59qyZPDWpo2FiRx6q4/rXdUVk6MWdtPH1oK17+pxUHhW+dwZnjiXvzk10OmaHa6f8wHmS/32rUopxpRiRVxlWorN2QCiiitDlCqwqzVYU0AtFFFAwooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAAMVbI/GpPOT1P5VFRQBL50fr+lHnJ6/pUXHpRx6UWES+cnr+lHnJ6/pUXHpRx6UAS+cnr+lHnJ6/pUXHpRx6UAS+cnr+lHnJ6/pUXHpRx6UASNMMfLyajHSiigYtFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUlLSGgApa4S2+1eJ/EGowXOozWkFo5RIIm2kgHGf0rT0uz1rR9eW0Ek17pUq582QgmI4P8An8aAOoorK1bxDpejuqXtxtkbkRqpZsfhUula1p+rxNJYXAk2ffUjay/UGgDQoqjpurWeqef9jkL+Q+x8qRg/jUdtrlhczXsUMpZrIkTZUjaQSD9ehoA0qK55/GmgpBHL9rZg+cBY2JGPUdq1rPUbO9sBe206tbkE7zxjHXOelAFpiFUliAAMkmkR1dQyMGB7g5FctqXi7RLqwvbSG7PmNBIqsUIVjtPANWfAhJ8K2xJJO5uv1oA6Gj6Vx/j6WdbjSIYLiWETysrGNsH+GotX0TUNG02XULHXLtngAYpKQQwzQI7aisrTdYim8O2+q3rpAjRBpCeAD0P61XsfF2iX12ttDdESOcJ5iFQx9iaBm7RVTUtTstKtvtF9OIo84HGST6ADk1S0rxNpOrXBt7S4Jm6hHQqSPbPWgDYorL1bxBpmjsqXtxtkbkRqpZseuB0qTSta0/V4mewuBJs+8pBVl+oNAGhRWBJ4x0OMurXTF0k8sqIznP09PerWreItL0hkS9uMSOMhFUs2PXA6UAaXmJ5nl713/wB3PNPrhrPUbfUviHFcWU3mQtbdRkc47iuh1XxLpOkziC7uP32M7EUsQPfHSgDYoqnp+qWWpWhurKcSRDrgcj2IrMh8Y6HO0KQ3TO8z7FURnOff0HNAG/RRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFJQBy1zo+j+I7iW+0y7eC7jba8sBIOfcVBpmpappPiWLQtWuBdxzpuimx8w69fyq3deFZEvpb3RdSl0+SY5kQLuRj9M1LpPhn7Jqf9p6jfSX96BhHddoT6DNAGZ4ZjS58Xa1PcqHnjfam7naue1MuEWz+J0K2ahRPbEzKo4Jw3X8ga1tT8NPPqR1LS9QewunGJCq7lf6ipdE8OJp13Lf3V1Je30ow0zjGB6AUCMr4e9NX/AOvs1T0A/wDEy8Wf9dJP/QnrUbwndQajPcaVrElnFctukjEe7n2Oam0fwsNL/tHbevML0EZdOU69Tnnr7UAVPh9a27+FyXhRjK7hyVzuGcVzmlyyp8OdS8sn/X4OOwOM13nh3SP7E0pbLz/P2szb9m3OT6ZNVNF8Lw6dotzplxP9pjuGJY7NmOMepoArGytE+HkqRxRsv2FpAdo+9tJz9c1N4C/5FW2+rfzqrF4PvFtnsG12c6eQQsITBx6E56e1beg6X/Y+lx2PnedsJO/btzn2yaAOa+IqyPc6KsLhJDM4Vj2Py4NUfEUet281pba9qXmadcSBZGhULj68V1mvaF/bNzYS/afJ+ySF8bN2/OOOox0qzrelQ6xpktlMdu/lXxnYexoA5Xx4gtdO0ixtIwbbzAAmeGwBgE/jSa3Ya9q1hFb/ANjWtuYmDRyRzcrjsOK35PDqXfh6LStRuWnaEfJOq7GXHQ4yeg4qnH4Y1JjHFeeIbia0jYERomxjjpls0AUdZVrjxpoltfAGMQhip6F+/wDKt7U9K0y41Kxu7iUW9zA+YirBC5yOPf8A+vS69oMOsLC4nkt7m3OYp0GSv+NUrLwxN/aUN/rOpyX8tvzCpTaqn16mgCh4bjS68Za1cXShp4n2pu52rnHFMuEWz+J1sLMBRcW5Myr0PDdfyBrV1Tw00+pnU9Mv3sLthtdlXcrj3FSaL4cXTryW/u7t72+lG1pnGMD0AoAw/A1lbT3+sTzQRySLclVLqDgZPSpNCjjufH+sy3ShpYuIgwztHAyPwx+dbmgaF/Ysl632nzvtUxk+5t2+3U5qtq3hl7rVRqmm372F2V2uyruDj6ZFAzKSKOL4pMI41QG3yQoxkkdazfDM+qNqWqXNpp0N3O8xEjSybSvJ4H+e1dLp3hd7PXF1WbUpLmbyyr705YnuDnge1Je+FpBqUt/o2pSafNMcyqE3Kx9cZoEVfDmm6lZ6hqlzd2sdtDcpuEcb7grc/wCNQfDaytW0eW5eCN5jMRvZQSAAOldBpGjyWEU/2i/mu57j78knAH0XtSeGtE/sDTmtPtH2jMhfds29cdsn0oA16KKKBhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABSUtFABRRRQAlLRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf//Z" width="325" height="235" class="img_ev3q"></p>
<ol start="2">
<li>开始录音。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-90-25052c02aaedccedac6011e4219b3592.jpg" width="1000" height="485" class="img_ev3q"></p>
<ol start="3">
<li>生成录音文件。</li>
</ol>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="601" height="161" class="img_ev3q"></p>
<ol start="4">
<li>同样，在录制视频的时候，也可以插上耳机测试录音。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-98-f21e6c2489e8b89fcad890d5c623137e.jpg" width="559" height="999" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="播放">播放<a href="#播放" class="hash-link" aria-label="Direct link to 播放" title="Direct link to 播放">​</a></h3>
<p>在 RUBIK Pi 3 中进行以下操作测试播放功能。</p>
<ol>
<li>使用上一小节的录音文件。</li>
</ol>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="601" height="161" class="img_ev3q"></p>
<ol start="2">
<li>
<p>佩戴耳机查看录音效果。</p>
</li>
<li>
<p>保证录音正常收听的前提下，打开 gallery。</p>
</li>
<li>
<p>能够正常播放视频并且声音正确。</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-87-0331fa5b29548794f3b967287a2d7985.jpg" width="645" height="945" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="调节音量">调节音量<a href="#调节音量" class="hash-link" aria-label="Direct link to 调节音量" title="Direct link to 调节音量">​</a></h3>
<p>直接操作设置中的媒体播放器</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-86-f3e817b5863aa55452450bb731f1d7d1.jpg" width="1000" height="371" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="抓取日志">抓取日志<a href="#抓取日志" class="hash-link" aria-label="Direct link to 抓取日志" title="Direct link to 抓取日志">​</a></h3>
<ul>
<li>
<p>内核音频驱动程序日志</p>
<ul>
<li>
<p> 内核日志</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg</span><br></span></code></pre></div></div>
</li>
<li>
<p>禁用特定文件中的内核日志：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo –n “file &lt;filename&gt; -p” &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="风扇">风扇<a href="#风扇" class="hash-link" aria-label="Direct link to 风扇" title="Direct link to 风扇">​</a></h2>
<p>与RUBIK Pi 3兼容的风扇请参考<a href="https://www.thundercomm.com/rubik-pi-3/cn/docs/peripheral-compatibility-list" target="_blank" rel="noopener noreferrer">外设兼容列表</a>。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>使用 RUBIK Pi 3 在运行一些高负载或高性能的场景下，需要使用散热措施来保证设备性能稳定，否则会因为 CPU 温度过高而带来降频等性能影响。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="风扇安装">风扇安装<a href="#风扇安装" class="hash-link" aria-label="Direct link to 风扇安装" title="Direct link to 风扇安装">​</a></h3>
<ol>
<li><strong>将散热器背面所有导热硅脂移除</strong>，将下图标记的两块硅脂按 RUBIK Pi 3 的 SoC 及 uMCP 的形状裁下。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-85-366fe97a31d0a20eba5925bf3fd8a015.jpg" width="977" height="778" class="img_ev3q"></p>
<p>两块的表面尺寸约为14*12mm和13*11.5mm。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-108-533ec0709f7bd6e4b194e4a41c48176e.jpg" width="1000" height="795" class="img_ev3q"></p>
<ol start="2">
<li>将裁剪好的两块导热硅脂贴在 RUBIK Pi 3 上对应位置。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250220-095205-8f289f5e09ad63efa16dff87f75dc053.jpg" width="1000" height="648" class="img_ev3q"></p>
<ol start="3">
<li>安装散热器，连接风扇排线。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155449-340c821500d37988d4fbd77f50f87fce.jpg" width="1000" height="750" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>建议将风扇安装到 RUBIK Pi 3 上后不要将其取下。拆卸会导致风扇的推针和散热垫退化，并可能导致产品损坏。如果推针损坏或变形，或无法牢固夹住，请停止使用风扇。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="风扇控制方法">风扇控制方法<a href="#风扇控制方法" class="hash-link" aria-label="Direct link to 风扇控制方法" title="Direct link to 风扇控制方法">​</a></h3>
<p>RUBIK Pi 3 风扇会根据当前的 CPU 温度自动调整转速，同时也可在 RUBIK Pi 3 中使用下面命令进行手动控制转速，0 和 255 分别表示风扇的最高和最低速度。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/hwmon/hwmon0/pwm1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 255 &gt;  /sys/class/hwmon/hwmon0/pwm1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 0 &gt;  /sys/class/hwmon/hwmon0/pwm1</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="led">LED<a href="#led" class="hash-link" aria-label="Direct link to LED" title="Direct link to LED">​</a></h2>
<p>RUBIK Pi 3 上有一个由 PMIC 驱动的 RGB 的三色灯，默认情况下其中的绿色灯被设置为了心跳灯用来反馈系统的运行情况和 CPU 负载情况（CPU 负载大时，心跳灯闪烁频率也跟着变大）。</p>
<ul>
<li>
<p>关闭心跳灯</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo none &gt; /sys/class/leds/green/trigger </span><br></span></code></pre></div></div>
</li>
<li>
<p>开启心跳灯</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo heartbeat &gt; /sys/class/leds/green/trigger</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置绿灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/green/brightness</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置红灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/red/brightness</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置蓝灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/blue/brightness</span><br></span></code></pre></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="以太网">以太网<a href="#以太网" class="hash-link" aria-label="Direct link to 以太网" title="Direct link to 以太网">​</a></h2>
<p>以太网技术旨在使用有线技术以不同的链路速度传输数据。它使用线缆在网络模型（例如局域网 (LAN) 和广域网 (WAN)）中传输数据，实现可靠、安全和更出色的网络连接。</p>
<p>以太网连接集成到 IoT 设备和传感器，使它们能够将数据传输到网络。它根据 IEEE 802.3 标准定义，可为这些设备提供用于与网关通信的标准化接口。</p>
<p>以太网接口为下图 8， RUBIK Pi 3 支持千兆以太网：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-106-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<p>接入网线，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155445-c2fa574a6fee2fb6734b5b5d02b9c32e.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>可在 RUBIK Pi 3 中使用下面命令查看网络连接情况，如下图所示，已经成功分配 IP，说明网络连接成功：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-107-0c7f74b2f8f274c54b8fba46157b551f.jpg" width="944" height="790" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rtc-电池接口">RTC 电池接口<a href="#rtc-电池接口" class="hash-link" aria-label="Direct link to RTC 电池接口" title="Direct link to RTC 电池接口">​</a></h2>
<p>RTC (Real_Time Clock) 电池接口为下图 1。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-103-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<p>接入 RTC 电池， 如下图所示，并将时间写入 RUBIK Pi 3 的系统硬件时钟，可在 RUBIK Pi 3 完全断电后，仍对 RUBIK Pi 3 的系统时间进行保存。</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/20250314-155435-93ad3034de03ade5b7e1dec6b9a778f1.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>在 RUBIK Pi 3 中可以手动修改时间：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-105-9be79de0093ae1c01a2d4f43f04c3a92.jpg" width="1000" height="324" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="m2-key-m-接口">M.2 Key M 接口<a href="#m2-key-m-接口" class="hash-link" aria-label="Direct link to M.2 Key M 接口" title="Direct link to M.2 Key M 接口">​</a></h2>
<p>RUBIK Pi 3 提供一个标准 M.2 插槽，用于连接 NVMe 存储，可安装 2280 规格（22*80mm）M.2 SSD 硬盘。M.2 插槽最大支持 PCIe Gen 3 x 2。M.2 接口最大对外输出能力为 3.3V 2A，可单独控制开关。</p>
<p>M.2 Key M 接口使用了 QCS6490 的 PCIe1 总线，设备路径为：<em>/sys/bus/pci/devices/0001:00:00.0</em></p>
<p>M.2 Key M 接口为下图 18：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-102-3c4ed5110077f3ade90d5272242520aa.jpg" width="1000" height="416" class="img_ev3q"></p>
<p>M.2 Key M 接口可以接入规格为2280的固态硬盘，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/img_v3_02h3_2bbba98e-82ca-47ed-9b20-cf96deb8e13g-ed2375f85ca402baaec1c50fa146ae76.jpg" width="1000" height="750" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/img_v3_02h3_f64471dd-11fb-46bd-ae8a-72fdf86cc65g-05587f56bfe89be7041aa84fd8324981.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>目前 RUBIK Pi 3 暂未支持固态硬盘的自动挂载，可在 RUBIK Pi 3 中执行下面命令对固态硬盘手动挂载</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /opt/ssd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount /dev/nvme0n1 /opt/ssd</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/android110.github.io/assets/images/image-100-b60a4f27998e9627a835dc19613609e0.jpg" width="688" height="343" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-功耗优化">PCIe 功耗优化<a href="#pcie-功耗优化" class="hash-link" aria-label="Direct link to PCIe 功耗优化" title="Direct link to PCIe 功耗优化">​</a></h3>
<p>PCIe 定义了两种功耗管理方法。</p>
<ul>
<li>
<p>功耗管理软件，用于确定每个设备的功耗管理功能并分别对各个设备进行管理</p>
</li>
<li>
<p>不需要软件干预的系统，例如主动状态功耗管理 (ASPM)</p>
</li>
</ul>
<p>当链路上未传输任何数据包时，设备会将链路置于节能状态。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-l0-链路状态">PCIe L0 链路状态<a href="#pcie-l0-链路状态" class="hash-link" aria-label="Direct link to PCIe L0 链路状态" title="Direct link to PCIe L0 链路状态">​</a></h4>
<p>PCIe 功耗管理定义下了 L0 链路状态：</p>
<ul>
<li>
<p>L0：工作状态</p>
</li>
<li>
<p>L0s：具有低恢复延迟的 ASPM 状态（节能待机状态）</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-设备状态">PCIe 设备状态<a href="#pcie-设备状态" class="hash-link" aria-label="Direct link to PCIe 设备状态" title="Direct link to PCIe 设备状态">​</a></h4>
<p>PCIe 功耗管理定义了以下设备状态：</p>
<ul>
<li>
<p>D0（必选）: 设备处于完全 ON 状态，此时存在两个子状态</p>
<ul>
<li>
<p>D0(uninitialized)：当设备退出复位状态后等待枚举和配置时，该功能处于 D0(uninitialized) 状态</p>
</li>
<li>
<p>D0(active)</p>
<ul>
<li>
<p>当完成枚举和配置过程后，该功能处于 D0(active) 状态</p>
</li>
<li>
<p>当系统软件启用一个或多个（任意组合）功能参数（如内存空间启用、I/O 空间启用、总线主启用（BME）位）时，该功能进入 D0(active) 状态</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>D1（可选）：轻度休眠状态</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过发出设定 PM 控制和状态寄存器的软件命令来进入 D1 状态</p>
</li>
</ul>
</li>
<li>
<p>D2（可选）：深度休眠状态</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过发出设定 PM 控制和状态寄存器的软件命令来进入 D2 状态</p>
</li>
</ul>
</li>
<li>
<p>D3（必选）：设备处于最低功耗状态，此时该功能必须支持两种 D3 状态</p>
</li>
<li>
<p>D3(hot)</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过设定功耗状态位域发出软件命令来进入 D3(hot) 状态</p>
</li>
</ul>
</li>
<li>
<p>D3(cold)：设备进入 D3(cold) 状态并断电；当恢复供电时，设备进入 D0(uninitialized) 状态</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-调试">PCIe 调试<a href="#pcie-调试" class="hash-link" aria-label="Direct link to PCIe 调试" title="Direct link to PCIe 调试">​</a></h3>
<p>M.2 Key M 接口使用了 QCS6490 的 PCIe1 总线，设备路径为：<em>/sys/bus/pci/devices/0001:00:00.0</em></p>
<p><code>lspci</code> 和 <code>setpci</code> 命令为 Linux 发行版的本机命令。这两条命令提供多种级别的输出，并且还可用于在某个时间点查看 PCI 总线上训练的不同组件的功能和状态。这些功能大多反映的是 PCIe 基本规范所需的配置空间寄存器。更多详细信息，可访问 <a href="https://pcisig.com/specifications" target="_blank" rel="noopener noreferrer">https://pcisig.com/specifications</a>
如需查看使用说明，可运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci --help</span><br></span></code></pre></div></div>
<p>以下功能有助于解决 PCIe 问题。</p>
<ul>
<li>
<p>显示设备信息</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0000:00:00.0 PCI bridge: Qualcomm Device 010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000:01:00.0 USB controller: Renesas Technology Corp. uPD720201 USB 3.0 Host Controller (rev 03)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0001:00:00.0 PCI bridge: Qualcomm Device 010b</span><br></span></code></pre></div></div>
</li>
<li>
<p>显示设备控制寄存器中的 PCIe 设备和厂商 ID。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci -nvmm</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        00:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0604</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        17cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        01:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0c03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        1912</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        0014</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rev:        03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProgIf:        30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        0001:00:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0604</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        17cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DTNode:        /sys/firmware/devicetree/base/soc@0/pci@1c08000/pcie@1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/2.peripherals-and-interfaces.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/android110.github.io/docs/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tutorial Intro</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/android110.github.io/docs/qualcomm-ai-hub"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Qualcomm AI Hub</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#硬件资源图" class="table-of-contents__link toc-highlight">硬件资源图</a></li><li><a href="#40-pin-连接器" class="table-of-contents__link toc-highlight">40 pin 连接器</a><ul><li><a href="#gpio" class="table-of-contents__link toc-highlight">GPIO</a><ul><li><a href="#引脚分布" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-shell-命令控制" class="table-of-contents__link toc-highlight">使用 shell 命令控制</a></li></ul></li><li><a href="#i2c" class="table-of-contents__link toc-highlight">I2C</a><ul><li><a href="#引脚分布-1" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-shell-命令测试" class="table-of-contents__link toc-highlight">使用 shell 命令测试</a></li></ul></li><li><a href="#spi" class="table-of-contents__link toc-highlight">SPI</a><ul><li><a href="#引脚分布-2" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-c-语言程序-spi-通信" class="table-of-contents__link toc-highlight">使用 C 语言程序 SPI 通信</a></li></ul></li><li><a href="#uart" class="table-of-contents__link toc-highlight">UART</a><ul><li><a href="#引脚分布-3" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-c-语言程序-uart-通信" class="table-of-contents__link toc-highlight">使用 C 语言程序 UART 通信</a></li></ul></li></ul></li><li><a href="#usb" class="table-of-contents__link toc-highlight">USB</a><ul><li><a href="#usb-20-type-a-接口" class="table-of-contents__link toc-highlight">USB 2.0 Type-A 接口</a><ul><li><a href="#设备模式验证" class="table-of-contents__link toc-highlight">设备模式验证</a></li><li><a href="#切换到主机模式" class="table-of-contents__link toc-highlight">切换到主机模式</a></li></ul></li><li><a href="#usb-31-type-c-接口" class="table-of-contents__link toc-highlight">USB 3.1 Type-C 接口</a></li><li><a href="#usb-调试" class="table-of-contents__link toc-highlight">USB 调试</a><ul><li><a href="#usb-跟踪" class="table-of-contents__link toc-highlight">USB 跟踪</a></li><li><a href="#主机-sysfs-查询" class="table-of-contents__link toc-highlight">主机 sysfs 查询</a></li></ul></li></ul></li><li><a href="#相机串行接口-csi" class="table-of-contents__link toc-highlight">相机串行接口 （CSI）</a><ul><li><a href="#摄像头排线安装" class="table-of-contents__link toc-highlight">摄像头排线安装</a></li><li><a href="#摄像头使用方法" class="table-of-contents__link toc-highlight">摄像头使用方法</a></li></ul></li><li><a href="#hdmi-out" class="table-of-contents__link toc-highlight">HDMI OUT</a><ul><li><a href="#hdmi-out-触摸屏" class="table-of-contents__link toc-highlight">HDMI OUT 触摸屏</a></li><li><a href="#hdmi-out-调试" class="table-of-contents__link toc-highlight">HDMI OUT 调试</a><ul><li><a href="#获取-lt9611-日志" class="table-of-contents__link toc-highlight">获取 LT9611 日志</a></li><li><a href="#获取-dsi-日志" class="table-of-contents__link toc-highlight">获取 DSI 日志</a></li><li><a href="#获取显示面板信息" class="table-of-contents__link toc-highlight">获取显示面板信息</a></li><li><a href="#获取-dsi-时钟信息" class="table-of-contents__link toc-highlight">获取 DSI 时钟信息</a></li><li><a href="#获取调压器信息" class="table-of-contents__link toc-highlight">获取调压器信息</a></li><li><a href="#获取接口信息" class="table-of-contents__link toc-highlight">获取接口信息</a></li><li><a href="#获取常规-dpu-调试信息" class="table-of-contents__link toc-highlight">获取常规 DPU 调试信息</a></li></ul></li></ul></li><li><a href="#displayport" class="table-of-contents__link toc-highlight">DisplayPort</a><ul><li><a href="#dp-调试" class="table-of-contents__link toc-highlight">DP 调试</a><ul><li><a href="#获取-dp-日志" class="table-of-contents__link toc-highlight">获取 DP 日志</a></li></ul></li></ul></li><li><a href="#wi-fi--蓝牙" class="table-of-contents__link toc-highlight">Wi-Fi &amp; 蓝牙</a><ul><li><a href="#wi-fi" class="table-of-contents__link toc-highlight">Wi-Fi</a><ul><li><a href="#工作频段" class="table-of-contents__link toc-highlight">工作频段</a></li><li><a href="#工作模式" class="table-of-contents__link toc-highlight">工作模式</a></li></ul></li><li><a href="#蓝牙" class="table-of-contents__link toc-highlight">蓝牙</a></li></ul></li><li><a href="#音频" class="table-of-contents__link toc-highlight">音频</a><ul><li><a href="#查看声卡信息" class="table-of-contents__link toc-highlight">查看声卡信息</a></li><li><a href="#录制" class="table-of-contents__link toc-highlight">录制</a></li><li><a href="#播放" class="table-of-contents__link toc-highlight">播放</a></li><li><a href="#调节音量" class="table-of-contents__link toc-highlight">调节音量</a></li><li><a href="#抓取日志" class="table-of-contents__link toc-highlight">抓取日志</a></li></ul></li><li><a href="#风扇" class="table-of-contents__link toc-highlight">风扇</a><ul><li><a href="#风扇安装" class="table-of-contents__link toc-highlight">风扇安装</a></li><li><a href="#风扇控制方法" class="table-of-contents__link toc-highlight">风扇控制方法</a></li></ul></li><li><a href="#led" class="table-of-contents__link toc-highlight">LED</a></li><li><a href="#以太网" class="table-of-contents__link toc-highlight">以太网</a></li><li><a href="#rtc-电池接口" class="table-of-contents__link toc-highlight">RTC 电池接口</a></li><li><a href="#m2-key-m-接口" class="table-of-contents__link toc-highlight">M.2 Key M 接口</a><ul><li><a href="#pcie-功耗优化" class="table-of-contents__link toc-highlight">PCIe 功耗优化</a><ul><li><a href="#pcie-l0-链路状态" class="table-of-contents__link toc-highlight">PCIe L0 链路状态</a></li><li><a href="#pcie-设备状态" class="table-of-contents__link toc-highlight">PCIe 设备状态</a></li></ul></li><li><a href="#pcie-调试" class="table-of-contents__link toc-highlight">PCIe 调试</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/android110.github.io/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/android110.github.io/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>